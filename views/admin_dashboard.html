<!DOCTYPE html>
<head>

    <title>Admin Dashboard</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,600;8..144,700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

    <style>

        body {  
            text-align: left;
            font-family: 'Roboto Flex', sans-serif;
        }

        h1 {
            margin-top: 5%;
            font-size: 30px;
            letter-spacing: 2px;
        }

        .event-block {
            float: left;
            width: 100%;
            display: flex;
            justify-content: center;
            font-weight: 700;
        }

        input {  margin-right: 10px;  }

        .warning {  color: red !important;  }
        
        .btn {
            font-size: 13px;
            background: #aaadb0;
            padding: 8px 30px;
            border: solid 1px #aaadb0;
            color: #ffffff;
            border-radius: 5px;
            font-weight: 700;
            outline: none;
        }

        .quiz-block {
            float: left;
            width: 100%;
            display: none;
            padding: 10px 0;
        }
        
        table {  font-size: 14px;  }

        .accordion { padding: 0 7%; }

        .button_groups {
            float: left;
            width: 100%;
            display: block;
            padding: 32px 5px;
        }

        .disabled { 
            background: #696969;
            cursor: not-allowed;
         }

        .btn-1 {  margin-top: 30px;  }

        .timer_demo {
            font-size: 40px;
            font-weight: bolder;
            letter-spacing: 5px;
            margin-bottom: 33px;
            color: #277BC0;
            text-align: center;
            font-weight: 700;
        }

    </style>
</head>

<body>
   
    <nav class="navbar bg-light">
        <div class="container-fluid">
          <span class="navbar-brand mb-0 h1">Welcome Admin</span>
        </div>
    </nav>
    
    <br><br>

    <div class="container-xl">
        <div class="row align-items-start">
            <table class="table" id="questions_table">
                <thead>
                  <tr>
                    <th scope="col">Sl.</th>
                    <th scope="col">Question</th>
                    <th scope="col">Option 1</th>
                    <th scope="col">Option 2</th>
                    <th scope="col">Option 3</th>
                    <th scope="col">Answer</th>
                    <th scope="col">Action</th>
                  </tr>
                </thead>
                <tbody>
                  
                </tbody>
            </table>
        </div>
    </div>

    <br><br>

    <div class="accordion" id="accordionExample">
        <div class="accordion-item">
            <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                Add New Question
              </button>
            </h2>
            <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo">
              <div class="accordion-body">
                    <div class="container">
                        <div class="row align-items-end">
                            <div class="col">
                                <label class="form-label">Question</label>
                                <input type="text" required id="form_question" class="form-control"/>
                            </div>
                            <div class="col">
                                <label class="form-label">Option 1</label>
                                <input type="text" required id="form_option1" class="form-control"/>
                            </div>
                            <div class="col">
                                <label class="form-label">Option 2</label>
                                <input type="text" required id="form_option2" class="form-control"/>
                            </div>
                            <div class="col">
                                <label class="form-label">Option 3</label>
                                <input type="text" required id="form_option3" class="form-control"/>
                            </div>
                            <div class="col">
                                <label class="form-label">Answer</label>
                                <input type="text" required id="form_answer" class="form-control"/>
                            </div>
                            <div class="col">
                                <button type="submit" onclick="addQuestion()" class="btn btn-primary">Submit</button>
                            </div>
                        </div>
                    </div>
                  <div class="mb-3">
                    
                  </div>
                  <div class="mb-3">
            
                  </div>
              </div>
            </div>
          </div>
        </div>
    </div><br>
    <div class="accordion" id="accordionExample">
        <div class="accordion-item">
            <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                Edit/Modify Question
              </button>
            </h2>
            <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingTwo">
              <div class="accordion-body">
                    <div class="container">
                        <div class="row align-items-end">
                            <div class="col">
                                <input type="hidden" id="edit_question_id" class="form-control"/>
                                <label class="form-label">Question</label>
                                <input type="text" required id="edit_question" class="form-control"/>
                            </div>
                            <div class="col">
                                <label class="form-label">Option 1</label>
                                <input type="text" required id="edit_option1" class="form-control"/>
                            </div>
                            <div class="col">
                                <label class="form-label">Option 2</label>
                                <input type="text" required id="edit_option2" class="form-control"/>
                            </div>
                            <div class="col">
                                <label class="form-label">Option 3</label>
                                <input type="text" required id="edit_option3" class="form-control"/>
                            </div>
                            <div class="col">
                                <label class="form-label">Answer</label>
                                <input type="text" required id="edit_answer" class="form-control"/>
                            </div>
                            <div class="col">
                                <button type="submit" onclick="updateQuestion()" class="btn btn-primary">Submit</button>
                            </div>
                        </div>
                    </div>
                  <div class="mb-3">
                    
                  </div>
                  <div class="mb-3">
            
                  </div>
              </div>
            </div>
          </div>
        </div>
    </div>
    
    <script>

        var questions = [
            { 'question': "How do you call a function named 'myFunction'?", 'opt1': "myFunction()", 'opt2': "call myFunction()", 'opt3': "call function myFunction()", 'answer': "myFunction()"},
            { 'question': "Where is the correct place to insert a JavaScript?", 'opt1': "The body section", 'opt2': "The head section", 'opt3': "Both body and head section", 'answer': "Both body and head section"},
            { 'question': "How to write an IF statement in JavaScript?", 'opt1': "if(i == 5)", 'opt2': "if i = 5", 'opt3': "if i = 5 then", 'answer': "if(i == 5)"},
            { 'question': "How do you write 'Hello World' in an alert box?", 'opt1': "alertBox('Hello World')", 'opt2': "msg('Hello World')", 'opt3': "alert('Hello World')", 'answer': "alert('Hello World')"},
            { 'question': "How do you create a function in JavaScript?", 'opt1': "function myFunction()", 'opt2': "function:myFunction()", 'opt3': "function = myFunction()", 'answer': "function myFunction()"},
        ];

        // Assign id dynamically
        questions.forEach((item, index)=>{
            item.id = index+1;
        });

        function deleteQuestion(questionId) {
            
            const questions = JSON.parse(localStorage.getItem("questionGroup"));
            if(questions.length != 1) {
                questions.splice(questions.findIndex(question => question.id === questionId) , 1)
                // Assign id dynamically
                questions.forEach((item, index)=>{
                    item.id = index+1;
                });

                localStorage.setItem('questionGroup', JSON.stringify(questions));
                location.reload();
            } else {
                alert("Unable to process your request");
            }
            
        }

        function showQuestionDetails(qid) {
          
            const questions = JSON.parse(localStorage.getItem("questionGroup"));

            const questionId = questions.findIndex((item => item.id == qid));

            document.getElementById('edit_question_id').value = questions[questionId].id;
            document.getElementById('edit_question').value = questions[questionId].question;
            document.getElementById('edit_option1').value = questions[questionId].opt1;
            document.getElementById('edit_option2').value = questions[questionId].opt2;
            document.getElementById('edit_option3').value = questions[questionId].opt3;
            document.getElementById('edit_answer').value = questions[questionId].answer; 

        }

        function updateQuestion() {

            let qid = document.getElementById('edit_question_id').value;
            qid -= 1;

            const questions = JSON.parse(localStorage.getItem("questionGroup"));

            const questionId = questions.findIndex((item => item.id == qid));

            questions[qid].question = document.getElementById('edit_question').value;
            questions[qid].opt1 = document.getElementById('edit_option1').value;
            questions[qid].opt2 = document.getElementById('edit_option2').value;
            questions[qid].opt3 = document.getElementById('edit_option3').value;
            questions[qid].answer = document.getElementById('edit_answer').value;

            localStorage.setItem('questionGroup', JSON.stringify(questions));

            location.reload();

      }

        function addQuestion() {

            let inputQuestion = document.getElementById('form_question').value;
            let inputOption1 = document.getElementById('form_option1').value;
            let inputOption2 = document.getElementById('form_option2').value;
            let inputOption3 = document.getElementById('form_option3').value;
            let inputAnswer = document.getElementById('form_answer').value; 

            if (inputQuestion != "" && inputOption1 != "" && inputOption2 != "" && inputOption3 != "" && inputAnswer != "") {

                const obj = { 
                    question: inputQuestion,
                    opt1: inputOption1,
                    opt2: inputOption2,
                    opt3: inputOption3,
                    answer: inputAnswer,
                }

                const questionsList = JSON.parse(localStorage.getItem("questionGroup"));
                updatedQuestons = [...questionsList, obj ]

                // Assign id dynamically
                updatedQuestons.forEach((item, index)=>{
                    item.id = index+1;
                });
                localStorage.setItem('questionGroup', JSON.stringify(updatedQuestons));

                location.reload();
            
            } else {
                alert("Please fill out all fields.")
            }
            
        }

        const table = document.getElementById("questions_table");
 
        var rowCount = table.rows.length;
        
        if ( localStorage.getItem("questionGroup") != null ) {
            var questionsList = JSON.parse(localStorage.getItem("questionGroup"));
        } else {
            localStorage.setItem('questionGroup', JSON.stringify(questions));
            location.reload();
        }

        questionsList.slice().reverse().forEach(function (question) {
            const row = table.insertRow(rowCount);
            row.insertCell(0).innerHTML= question.id;
            row.insertCell(1).innerHTML= question.question;
            row.insertCell(2).innerHTML= question.opt1;
            row.insertCell(3).innerHTML= question.opt2;
            row.insertCell(4).innerHTML= question.opt3;
            row.insertCell(5).innerHTML= question.answer;
            row.insertCell(6).innerHTML= "<a data-bs-toggle='show' data-bs-target='#panelsStayOpen-collapseTwo' aria-expanded='false' aria-controls='panelsStayOpen-collapseTwo' onclick='showQuestionDetails("+ question.id +")' href='javascript:void(0)'>Edit</a>&nbsp;&nbsp;&nbsp;<a onclick='deleteQuestion("+ question.id +")' href='javascript:void(0)'>Delete</a>";
            
        });

        localStorage.setItem('questionGroup', JSON.stringify(questionsList));

    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

</body>
</html>